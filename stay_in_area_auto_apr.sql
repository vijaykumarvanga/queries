with dump_1 as 
(
select
    captain_id, coalesce(zone,'Undefined') as zone, 
    sum(accepted_pings) as accepted_pings, 
    sum(total_pings) as total_pings
from 
(
select 
    captain_id, pickup_location_hex_8, 
    count(order_id) as total_pings,
    count(case when event_type = 'accepted' then order_id end) as accepted_pings
from 
    orders.order_logs_immutable 
where 
    yyyymmdd >= date_format({{start_date}},'%Y%m%d')
    and  yyyymmdd <= date_format({{end_date}},'%Y%m%d')
    and service_obj_service_name = 'Auto'
    and service_obj_city_display_name = 'Chennai'
    and event_type in ('rider_reject', 'rider_busy', 'accepted')
    and captain_id IN 
    (
    '5c5874d7f2edc733674d8067',
'5c6fe13835478b560279ac2f',
'5c73a0f6343a5357615d3049',
'5c7d493a875c98536261291b',
'5c8b524e8c352421eaeb03a9',
'5cb1754654bc7263ff365d08',
'5cb5479d54bc7263ff3baa83',
'5cbbd9a954bc7263ff448cf8',
'5cbc18c83d65ca5e255ee5df',
'5cc49d443d65ca5e2564b4c3',
'5cc5ddd43d65ca5e25654988',
'5cc92dc53d65ca5e25674188',
'5cd44d14d2ee6e6cf2de3bf9',
'5cda7416d2ee6e6cf2e8559a',
'5ce64a3725ee3218d4d9e785',
'5cf7125dc0b26018f5d943a2',
'5cfdf03855623c757c101904',
'5cffd9b5ca6e2921117ab40b',
'5d009e2eca6e2921117b4929',
'5d0210d1c0b26018f5e43109',
'5d03d8e7abbf484763820de8',
'5d067321bf8d5b5fda04921f',
'5d075b312c115b5fd4d1068b',
'5d075dcbbf8d5b5fda05abf6',
'5d07964957152c471e0177b3',
'5d0bc89857152c471e06f802',
'5d0c8ddc0eed7c44be2ab2b1',
'5d0f2dc90eed7c44be2b9d12',
'5d10e86cd1212c6a896c592a',
'5d14702593686945e7062ae9',
'5d1ed8ff3b752c45cf979d08',
'5d20c57693686945e7162d54',
'5d26db8016609737fa46dfa5',
'5d2c3c1f11e17032dcf0b896',
'5d2c537e16609737fa4e7a36',
'5d2c816406ee2c37f1f9c11c',
'5d2f1bf36ed7674e61166e12',
'5d2fccdf6ed7674e6117129b',
'5d35d6035e335b75b152d2dc',
'5d3b14c93860423ec782a15a',
'5d3bc8779996733edb035f93',
'5d3fdf659996733edb085317',
'5d49571fbde10e0d542f68ed',
'5d4fd893bde10e0d5438541e',
'5d57868255fbf50d45f93ce4',
'5d59263d95e84053d766a357',
'5d637aaf357698118393bce0',
'5d664e3dd0286d106d68ff3c',
'5d6a5a4ca24c96105e305e3c',
'5d731ad8d0286d106d7c7150',
'5d73eac6a24c96105e3f5fa2',
'5d7b5a1aa24c96105e4b0f5d',
'5d7dad92a24c96105e4eadb9',
'5d83a550486b0b21476e745d',
'5d88b3f9486b0b214776d859',
'5d9ea492a1f0a71c60614778',
'5dad76eea52eca27857f5a55',
'5daddab2422e2b23e5a1e0a0',
'5dbd2c8934054849201568ea',
'5dc127fc34054849201daee7',
'5dc23f1334054849201ff7f0',
'5dc2aa853087fd49363b91ac',
'5dce4ec80856f146182dff9c',
'5dd1ea9f010c5a46010c4567',
'5dd5089c59e2e3257f793283',
'5dd7ba3f61ebec69bf957ad3',
'5dd7faba61ebec69bf965e0c',
'5dd8e13261ebec69bf982316',
'5ddbc47f6ffaa931412b8bee',
'5de08462fec18c7500b01d26',
'5de3e8a639cbc02e90945633',
'5de4ca1739cbc02e9095338e',
'5de61c01ac56a62ec5e6990e',
'5de7c98623da8b6b4b7f5469',
'5de89b682b420f6b522dd308',
'5dea6931fa8847337e194810',
'5dee5a788b30716fdecadcc2',
'5def5941b619aa257e597cbd',
'5df02ae0d01edf2b243930c6',
'5df2409f1471f12b2a91dfd9',
'5e05dc3210e94832d1734399',
'5e09b8d518576832ff82db85',
'5e0fa2b539136622c07c0abe',
'5e11d5cc89355c2289aa6c09',
'5e11d8d189355c2289aa6ffc',
'5e15867e19c15a286fdfd495',
'5e158d886b240a5b3dec0af0',
'5e23dbcc430121028f98e348',
'5e4183b06bbfd42b2bdfa032',
'5e476a1f14f14a241bbc038d',
'5e47b04dd76b095f5e91269a',
'5e481ac21656846254b63d1c',
'5e4cc1ef7ea4250d5b6cebfd',
'5e4e2d3e65613e429442c5b7',
'5e4e9670431949a347b08e8d',
'5e4f5097b973f646c7798269',
'5e569c8cc764cc6b16473f57',
'5e5f8c8e6738314de260177a',
'5e60accf96c65baac8d46c1f',
'5e63b995f41eb5b058766d03',
'5e650fa92aee86ef49686fe1',
'5e6b230e6ecc857a4addc249',
'5e6cfe51c8fe8344adff9e3d',
'5e6d82e5f5e4a835709fa91e',
'5e76392a98da06f2ee9dfd1d',
'5e7afa3ff496332bf4309f35',
'5eeca801ec73cb82a3459d47',
'5ef32337ec73cb9c39470477',
'5f3410e50fbf9616ff50dcde',
'5f46385608f2ced56b5179d5',
'5f4c82b1f330ba14410c5d42',
'5f4d14e6be98bebd703797b4',
'5f79715cf9451d0e39d978e6',
'5f7ab56bf9451df416d9eaf1',
'5f7d982c28d41499b8322e22',
'5f7ebe94949c03ce2ec00f65',
'5f81309c187b16317b186ac8',
'5f8156a427ab4ecf4e9e002f',
'5f81719a4002049663573e91',
'5f82972f4002045ae6579fc9',
'5f83f3560d1cde78efff3fc4',
'5f848055875b8b64ba689038',
'5f86a8ebb12fa8306bdb3856',
'5f86e6eceb17fe332437c8a6',
'5f86ecb0cd541af37220126b',
'5f87d9b846da1f547437d0a5',
'5f880c5597bae16d7fa151c3',
'5f88288b97bae11413a15e17',
'5f88453497bae15290a16a90',
'5f884554e037d396257e88c9',
'5f88632da4df425349b761d8',
'5f894a4ab71163030adf54ec',
'5f89605bca67591ba7005c80',
'5f8979c7b711635a15df6b52',
'5f897b1dfb10b836f9247fce',
'5f8a955cf60f1c80fcaab7c6',
'5f8a97eb863bfc3ed79d2d22',
'5f8a9f41402ed539fb66560e',
'5f8ab8b1b711639f37dfddec',
'5f8ace4bca6759170e00e31f',
'5f8ae72c402ed590e166728e',
'5f8d5ce8ca6759105901c923',
'5f8d701cca6759660a01d0ca',
'5f8d7690bf0b68c1ac538aff',
'5f90ed39bb047074c7b5aa21',
'5f9156d3893916d158f1a326',
'5f915a82ad20981cb0b5966a',
'5f91693f2c197e18a51ce557',
'5f923c62d8f8406399ee0a22',
'5f924f7cd8f8405c6bee13f5',
'5f9265176e83e44bd2101778',
'5f9271c1d8f840af42ee219e',
'5f92d812103b481e14201886',
'5f93c2508c8b63417e9bcb70',
'5f93e47b041d864f4d4c2df4',
'5f97c1705fd6fc366e9e7d3d',
'5f97c62c5fd6fc92ae9e7f5e',
'5f97ee625acac62332191cf8',
'5f99042f706913b6fdfe52dd',
'5f9912e2fce7300b4edfc368',
'5f9919697069134683fe5b80',
'5f993a46a630207c990eed46',
'5f995d56ff48fe2e58f3714e',
'5f9963ee7069139ef2fe75c3',
'5f9bffc5047afa41e12f3b91',
'5f9d0d7ef9b35a7d4b370aeb',
'5f9d2538ff48fe76e2f4815a',
'5f9e19362f1376534e9f283c',
'5f9fe4d9ff48fe13e9f54f0a',
'5fa0113bff48fe0dbff55e6f',
'5fa24496401c6a588edbbeac',
'5fa2a2b82053eed919114a3b',
'5fa3dae382ecf71a97a78c87',
'5fa4de08ff48fe9062f6cdee',
'5fa50a218a3d6333e20f76db',
'5fa64e9532de97e9868c2127',
'5fa79a33e624dc008d8a9c8c',
'5fa8f1194a320ba4ae6ab054',
'5fab856f90d779d8c6b8ebf0',
'5facdf139954afa03e8cc9a7',
'5facf7e19cd6073e280b4d53',
'5fad3a007e483fdd00f996d3',
'5fafa5d8893352ff34d7818b',
'5fb32a517e483f69d3fb50b9',
'5fb38b4abc2ae57e97a6d606',
'5fb39c3e7a3a354dcb6d6849',
'5fb4bf68e4116201ab22adad',
'5fb6165538dfd08d35be480a',
'5fb61a077118b22860031499',
'5fb67bd97118b2c4400336c1',
'5fb773c46db31f0f8a379dc5',
'5fb8cf0590d7797816bcd1a5',
'5fb8fb2b20edabc38b11c5d9',
'5fb8ff8a106fc33b96ee7df7',
'5fb9101d3b88d75649f7d3bc',
'5fb929f17821ffb5d7a3e5d5',
'5fb9e8cd7e483fc0cafd561f',
'5fba5a2ad2acf54854a2ed2a',
'5fbb53b690d7791cddbd92c8',
'5fbba37fd9cd43552827518f',
'5fbcbdbc40bdefd3ba9588fb',
'5fc10616014147ea360ab39e',
'5fc2ad0b808c7a8a2215c5af',
'5fc38fab01414782070c0afb',
'5fc4a8b1014147816e0c9389',
'5fc4c9f4808c7a92c116e40f',
'5fc5e187c5ea9e6d91371814',
'5fc7115c014147db4a0dbeb3',
'5fc72887a6425e22ffacc7b0',
'5fc7c3d35441f86af742df5b',
'5fc8fea65441f8c8ec4376ae',
'5fc9f4460141478ef80f35af',
'5fcb3292fc9e2055a8905d19',
'5fcdeba13ab0f7c1c1f3840c',
'5fcf4a4d014147d34511e439',
'5fd0660d01414766d812657c',
'5fd071a301414720e5126f80',
'5fd1a90f2ebe76edf92b32d4',
'5fd1abdbce5e6d3799ab15d9',
'5fd1d78b5441f883c547ca42',
'5fd3200b5441f8826b487179',
'5fd339c55441f80c36488467',
'5fd3527d5441f82eaa4896c6',
'5fd487d65e98cd67022f54cc',
'5fd4b3075e98cdd63d2f6dc1',
'5fd5f4b5ecbb3fe5e6266ba3',
'5fd8638c152df310f1ccf240',
'5fd8664a9aa947b58c603385',
'5fd91e6a08e6157c39ca523f',
'5fd9983a49fb26365de78184',
'5fd9c54f49fb269ac2e7a657',
'5fd9e73259db053c098fe6a4',
'5fda261549fb261724e7ea9e',
'5fdb13d64319a785c9b024b2',
'5fdc8bfd7afe7e76e369bada',
'5fdc97747afe7e467669c3a7',
'5fdca79d7afe7e39a869d011',
'5fdcf9c24319a7735bb137d7',
'5fdd8e3fbb140a7b89b123ef',
'5fdf3ad44319a7c176b2734a',
'5fe1ba0c328a86c5c9eff3b8',
'5fe210a6026a40977cca5071',
'5fe245164319a77cb1b406d6',
'5fe3121ab83de261ef0c7c35',
'5fe419cc4319a73424b4cd5b',
'5fe445a012a3e74c0f64a9dc',
'5fe5ddc4026a40eec9cc3794',
'5fe9aab2026a4045eace2aff',
'5fec130eee2e9c49d881bc34',
'5fed7f8bbd3aea05aa38b88e',
'5ff6d515857d1bc28c268472',
'5ff96ad26ac33a014bb83029',
'5ff9e38b87d7410a3b21e5e1',
'5ffd4c9987d74169702360ec',
'5ffd4cef01b191681cba7bc4',
'5ffdbc7620c2ac4b90e2c0c8',
'6006b300857d1b85272d9865',
'600bd699a1baed8184e39bd7',
'600e7917027f250398a2e46e',
'600faf177143236741c29a48',
'600fb276714323f26bc29c76',
'60126d1ca5ef07048c88c559',
'6014e6957143236dd7c4ebe4',
'601e4e7fb3649177f939552a',
'6020e9afa6cc79a6c722d48a',
'60238f27e41c2c13bc521cba',
'6027c25819e4982c0c1dbd70',
'6028d5d9e32da93f96b30048',
'602aaa96e32da9556ab3fb70',
'602d68c5e32da97598b54dea',
'602e123ee32da90036b5910f',
'60349157454cef51795ec947',
'60372df3f7d42e33d65b3f57',
'6038f1f9e9619e837fcea3d1',
'603ddaba654ed5ec1888ac71',
'603f5b3f85047445d2322104',
'6040b49aa5f4caf0f2286639',
'6044845b724f1f511ecc40ca',
'60499f960ebcf5850757f0a7',
'604b4743443ae06e8d54ef0c',
'604c10365e55c354dbcc1ad9',
'6051a7110122e37e4aca9e44',
'60535e8d4316f129c5ff916b',
'6054d02bba88aa707564ce6b',
'6059cc7103f2a42eb31e5cac',
'605ae9129203455abab365ec',
'605c7b8c70424a0d70f5d83a',
'605d7a68b244dc2d14d898ce',
'605db67a476329a980611313',
'605dc539b244dcfa16d8d4a0',
'605ecda567271d8152e4a2d4',
'606197fa193b5c0d8103e86b',
'6061ee0f03f2a485f722da81',
'6062ac876a86e9f6e5fc85f4',
'6063511103f2a4345e237cda',
'606418d0193b5c2c6705168e',
'60655e9ba2f9c51a054fa348',
'60657b1ee774ab2f24491673',
'60681c570292f45d0c154be6',
'60694181a2f9c5dcf2518e8a',
'606b03419772fdfd5767efac',
'606bce7ca2f9c56d7a52ddc8',
'606e881277616052d218d070',
'606fdb917f2983e6cf2507fc',
'6073e957180f920e870f1191',
'607972bb255e27b10cbc8c3d',
'607c59b8c1137321b6b9be5c',
'607d45e78b8a4a54fbe4d81b',
'607e6b24c11373f775ba98f2',
'607e7fb9255e275207bef2b2',
'607fc2f0f5837533beb2979f',
'60822f5cf583755e8eb37c4a',
'60839d62a54f8446a347af0e',
'6086852aa54f84d02f48e52d',
'6087a6b64b2ccd00cfacba52',
'608928fca54f84507649e491',
'608faca9272318ad19200ef6',
'608ffc422723183e3520384e',
'6094c7c30c98f71e1b9841b5',
'60bdfa6129a6940922b773a8',
'60d2cc5f0546892272ddcc46',
'60d40cea0546897fe4de67f1',
'60d463baf5cf11663c95a8bb',
'60d6b4a6569b2605766a58ef',
'60dc137c09aa9938483c3f41',
'60dda82809aa9935983d43b0',
'60ddb544569b26f44a6e7ae4',
'60ddb8c8569b262b7d6e7e0d',
'60deb2ab09aa99294a3dcdf6',
'60efb8b20d1ac7da619dfc41',
'60f955ecd417d435dd7d617a',
'60fa454222600c41336d1bb0',
'60fbb085fe2f60423f869d20',
'611214308dddcbd6316b53fe',
'61149f2cf3519d02dd40ab0c',
'611759088dddcb2ed36e575f',
'611a5169d8ec8ecdb20d1ba2',
'611bb5b4a1477f27c48e5012',
'611d288a255cc36a9d9fb8e6',
'611dda48b8c9cb739715e703',
'6121126701c2c3d5833d68f8',
'612883e334b93d23b332c969',
'6129cae83d08ee8b37274c59',
'6129cb473d08ee1eee274ca2',
'612e879d9db16be87aedd5d5',
'6133394b0a1f1b3975f7b298',
'613734dc7f5ff7277dfece2b',
'613ee79105add50e905ae11e',
'614035127f5ff750b50506fb',
'61404f4c7f5ff7103e05232f',
'614c1e5fe8f223c268ad4854',
'61505715f2602c3db12bcd53',
'61514e4dfd38d3e62b89521e',
'615d29457fefc535bd8a1b47',
'615fdd643cb5bb837b2c32b9',
'61651a37d323b79ab58dd6f5',
'61680be6fbce667e889864cc',
'616e29284c6ba18020d8ebc2',
'617121ca4c6ba12597dae5bf',
'617276a6b9941b24222418b7',
'617958dc5b3fed34857dbe59',
'617d0b7b80efde400acc07bf',
'617ee78a16ec5276c0d18c4b',
'617fe23ac324823345e49df7',
'618a1e85e3dc896a0fe8ceab',
'618d5223c98cb32bf0fc06a0',
'6193545f6837cce38b2f7474',
'61973a7e92730466fa94ccfb',
'6197c0583f25c3c749e1a303',
'6198ae483f25c3d9bee2475b',
'6198c9ea9ce5a3813e2fee38',
'619ba1f65f686bfe8a26470e',
'619d19b73f25c3f532e5c58c',
'619f236c6dc7056c764aa1c5',
'61a87b778472c984e759c580',
'61aaf94d17dd6a4f1a097870',
'61ad7bfef3de6f0ad143f625',
'61aee92cf871730a3d0e80c7',
'61af059df3de6f267f4530f2',
'61af08c017dd6afb1f0ca807',
'61b191b272f1dd1761919881',
'61b2ddefbd965e2c5abcf234',
'61b2e431bd965e85e5bcf791',
'61b9f5934c21d904e83cb137',
'61baab7f5f14f3a4054c0fcf',
'61bd75b1faf602c5cb3c420a',
'61bdf9554fc4130074359e7e',
'61bf29fcd97aca32dd7048ff',
'61bff329b125758ef5624952',
'61c15cae3beb3e3483c90ff6',
'61c5833bdf461973d0d89f27',
'61c99dbeebf26502e175aa6f',
'61cbf541a9fcc30783a65ffb',
'61cc0b354004b90d9874a7a0',
'61d3df9e6fe64101d3f12888',
'61d53d05ac1399a4c9b439b6',
'61d6babe7f6cb529e048d05a',
'61d6ca440a28e3c25cac8390',
'61d7fd28dd82c2487e20d458',
'61d819d6d9d234aa3854a0ce',
'61dc4c225f41a44f1a1fa819',
'61de54f4fb8e4d9649334913',
'61df8a57d80f2b4f9ba6211b',
'61e29d2f93bdd07be9dda5f2',
'61e2aee40fe854ec5f862d7b',
'61e45a8f50f34b8a6c8d1d9c',
'61e5519cd2553eaf178940d5',
'61e643bbb042132c853af443',
'61e649edb042131afb3af9b2',
'61e698319361413bcf5eea69',
'61ea6034ced19303e8b36e18',
'61eb65336916b8452da7dfc6',
'61eb930a63b2be79bc868193',
'61ee3aa86916b8fcd3a9d773',
'61efdaebebef82878e251d75',
'61f266966916b80514ac9978',
'61f37f9f6916b8e8ebad3336',
'61f38b756916b84818ad3db0',
'61f4dfb1c8b478e935dc74db',
'61fb6d2661129cb82c26dd67',
'61fb8d417ac9fd3485a153b1',
'61fcdcfd540ed8dc3c433195',
'61fe46b2d86d1058ade241ce',
'61fe4986d86d105256e24441',
'6200c18e30737358bff28c5c',
'6200ed5e30737325c0f2b28a',
'62025802d2ae40410b98f9e7',
'62048f0d725c4c1844b136a0',
'62080540d96a7ab307bf3f8d',
'620a0e9657d2b23f8faf39d8',
'620baa8efad59918a0bfdc71',
'620d0d5bd96a7a5cb8c27ee3',
'620d447dd96a7a84ecc2a7b3',
'620de8910152021034128a20',
'620df2d863e7c856790761f6',
'620f622cd96a7ab59fc3e00a',
'62176a1d853dd1b1bfc3e801',
'6218756360b553eb21826a64',
'6218f050656bb348449e85a2',
'6219c025c1a4e468f15dc2f6',
'6219dc70f0b26b0ee25b04a6',
'621b1a97ac1f970787ae74ba',
'621cf77ef0b26bfe095d68f3',
'621df80233ff94328f0a5a4c',
'621e3b7c33ff941b590a943d',
'621f63c3e016e7daa3a17242',
'622b4abb1811dca595850937',
'622b4fdd1811dccb21850d07',
'622f1a6fbbd0608ba0e96413',
'623008e0e33a23738da1052f',
'6230832fb73f574a7acec8a4',
'62318e652b721229859c1478',
'62330f1bfb8cbbd5f067a113',
'623882aaa63f416bffd8a1bd',
'623b2943b9a21e1f7dcc2884',
'623c2692f850f8c98e23ec6c',
'623d6702a198e1806e8684b5',
'6240363559c2214a2962197e',
'62405675d1c27cd2e753c547',
'62413a186e78d17ccffa21c4',
'624409fdfbfa43f9bac8573a',
'624434bc1d069131bbca8134',
'624534b863e40dd5ce14e3f3',
'624a91323b51a5daa1ea997a',
'624aa2ab259388834d3d53aa',
'624adab525938845783d7cc8',
'624d3f9cf73d4c35cfcacd07',
'6252aaa528276475ff99bd11',
'62543cdefd03f9c71efdf1ad',
'6256c78232edcd5a30dc5189',
'625fcb5026e6f42996f1e0c5',
'626377a261b1e82112327305',
'62678994aa67db02b91cd49a',
'62679ab0797562db5a42323d',
'6267caeeaa67db66e91d0287',
'6268f664aa396b9203879e51',
'626a3f87ad3d65269593f6e4',
'6274bc9920022e0072877770',
'627a4ab9c75b902088067d2d',
'627b5182d4942229aac3081c',
'627b9ea687b0a63734c5dbb1',
'627cddee9a2aab80bb5bfea4',
'627e04103645c9824f91d0f5',
'627e1d923645c9b41191ea9a',
'627e3b1046fe3b693f591636',
'6280524dcf1a864a7508f3c8',
'62831be579cc7204826638b1',
'62835e8f383becc7200febbd',
'62846d6c1aeb746b24011169',
'6284c18d50881c7a65994407',
'6284f610cf1a86049f0d0061',
'6286eb70cf1a86c0db0e63be',
'62870adfde20662517c45e11',
'628852cb4281e532ef335dfd',
'628c63c9991337707e34f25d',
'628c77cd3a7449bfcd5f73b9',
'628c7ed5de081125764221af',
'62904cc9e5106f54bb9dff8d',
'629061439913374fe5381906',
'62906ffe991337a8d1382693',
'6295b4b774c071dc86507284',
'62962dec970d3970debb7b61',
'629711b999145779820c9240',
'62971c5ca6b6c1bd081b751a',
'6298b195f3675083743ac05f',
'629c21171fdbdeea4ee0db3d',
'629cd180c1ef3ebeeb2cccb0',
'62b41b6d14f9290ecafb0fdb',
'62b5a07f8c7d14b1b306481c',
'62b5eb2bb6ba98aacbc54f08',
'62b8e49d7d7967fefbf45df6',
'62bbd2afc6ae81665ee64b0f',
'62bd07357d796717a9f72cd1',
'62bd8b2fa586e67e7e0d7bd6',
'62c32c1a5bce423777aea65b',
'62c528cc17b40299229ee006',
'62c6308717af9a05796be632',
'62c7c094551cdb4693bf696f',
'62cbbed6551cdb0884c2571a',
'62cbf8aed32c16e098a67d57',
'62cf98625855ad62f9eb20f6',
'62d1093cbb4dfbec5983de65',
'62d2510cb53fa302d32c6edd',
'62d63b8f687a183075185aad',
'62d649b22091d8d65400f38f',
'62d6984fcfb4ee7256637fb2',
'62d6ac3546b3887de8b18961',
'62d7e2296af03d2d53c13939',
'62da9e774354c63912e3ae35',
'62e0fdb76d8d08ef3bc119e6',
'62e0ff3a6d8d08fd61c11af0',
'62e24852cb615708a25c7e9e',
'62e388e1d8a249cbb4af392f',
'62e5c2d3cb615709ac5ecf39',
'62e69cc86d410e227bcfe3bd',
'62e7de5df1e214ef8f90d311',
'62ee13a5cb9a7c2bd5cfc921',
'62f33876efa3e70a90dfbd03',
'62f4cd9b9e82c8bbf4a7a1a5',
'62f88e836c149cb633a73ea8',
'62fddc1e07de6085ce781f95',
'62ff25f885619216e996f8a0',
'63007a0445985b7103c3a808',
'6301a93c04cb1b63150c500d',
'630345a133bc8952d508fbee',
'6309f7c681735c99486cab1a',
'630d9665fb9d0c6cef9605aa',
'630e29b26670f1cb21c0a212',
'63106bc5dbaa3b362c3f22df',
'631578472b45e56f8c36f5e5',
'6318408150e9ee0e1c8bb9be',
'631e3ae1bc07730f40c681e6',
'631e8e3cbc0773021ec6ad78',
'63216919f7a518cefc49bf1d',
'632450ff1152d9aa49ca31f0',
'63288d69bb9d6236692220a7',
'632bbf90868f896f4eb10f4d',
'632d31d9f29a4219636d3268',
'632d7623adb1f8671beb166c',
'632ed8312ac0aa3419df5bd4',
'63314eeba4c572e18111c11c',
'633277c0702da630acf63493',
'633552116b27ad5b4b0d8b36',
'6336aefdc9e099118c3fdfe6',
'633ad5d152124044ebefac5d',
'633ad7fae90ec6f7167d71bd',
'633bb27fa9b2f2f2c96e72aa',
'633fef29e7acac5222d7ed82',
'633ffd6076a9b365ada2856a',
'63411b54be6aa7735e279c9a',
'6345407dd7a401281620a085',
'63490d0045469a0a77756e24',
'63490fb394c4a70e74bc85a9',
'634a4b8b213e322b6c9d82aa',
'634d0f43d4aec2939255e916',
'63526c3ed58af749f6d4c47d',
'635386b4d58af70ce0d58313',
'63569c07eefe8f321f641872',
'635ba530d58af7d280db6625',
'6360b85485b39966b956e234',
'6364df5685b3995c4659abca',
'6367432d85b399b2315b5e97',
'636c8e9639c4ec527a2634f5',
'636dc971ec5c22eda6a68801',
'636dd33fae4832d295d6d5aa',
'636de9fcec5c22dc53a69ee5',
'6372575fb48cddbed2fb1063',
'6375ffc2743ac75620f537b6',
'63773f4683ee530be840a409',
'637e361c5b774180fa7cc350',
'63806f9ce0b9788cd6469958',
'63882e6008087f6234a202af',
'6388606fe368d2b553c40104',
'638993280feaabfd096e44ac',
'638d86d4f34c21ccdfb983f0',
'638d8c645a8f9d241a0a1be5',
'638db3b35a8f9d059c0a3c57',
'638e0fa355f3fa18d6603e78',
'638f27bb33b5cd35cceef5e2',
'639ae004e3d8b5e060c7ca2b',
'639d5b3dcbf93101036c3918',
'63a28dfa92f1c03cb0ca8b20',
'63a2ca9b7a986a5e750d443d',
'63a6f06dc28f680721e73b3f',
'63ae66d17c26210f0f14b811',
'63afcbd642628eda100fccf3',
'63aff9a9de481977bb04eb50',
'63b1aea9825607498d333c99',
'63bd0bd348e9d3693abaac2a',
'63c8d4b6ec19f0c28159349f',
'63c9043d491cc6eb949839da',
'63c91735b07a9c03fce52a70',
'63d6121b63e6d4695c96b2b2',
'63d63569e2fc042f74400401',
'63da0abf7bc906069cc6b5c3',
'63dcd917a0facd2b2228c0cc',
'63e6308f0eb8c31321a04445',
'63eae4c840c28d7740c5bb15',
'63eb286ef021de915b03b2f3',
'63eb587655dc132a313e7df5',
'63ec92a5aab31086827bcde7',
'63eddc48d7e8b237c8ad84c6',
'63ef2402871d6f67434037c4'
    )
group by 
    1, 2
) ord_im left join (select * from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab 
on ord_im.pickup_location_hex_8 = zne_tab.hex_id
group by 
    1, 2 
)

select
*
from 
(
select
    dump_1.*, accepted_sum, total_sum, 
    cast(accepted_pings as double)/accepted_sum as accepted_perc, 
    cast(total_pings as double)/total_sum as total_perc
from 
    dump_1
left join (
select
    captain_id, 
    sum(accepted_pings) as accepted_sum,
    sum(total_pings) as total_sum
from 
    dump_1
group by 
    1 ) sum_dump 
    on dump_1.captain_id = sum_dump.captain_id
)
where 
    accepted_perc >= 0.6



    -- limit 10 

---- 
newquery net orders 

with dump_1 as 
(
select
    captain_id, coalesce(zone,'Undefined') as zone, 
    sum(net_orders) as net_orders
from 
(
select 
    captain_id, pickup_location_hex_8, 
    count(distinct order_id) as net_orders
from 
    orders.order_logs_snapshot
where 
    yyyymmdd >= date_format(date('2023-02-13'),'%Y%m%d')
    and  yyyymmdd <= date_format(date('2023-02-26'),'%Y%m%d')
    and service_obj_service_name = 'Auto'
    and service_obj_city_display_name = 'Chennai'
    and order_status = 'dropped'
    and (spd_fraud_flag = false or spd_fraud_flag is null)
    and captain_id IN 
    (
    '5c5874d7f2edc733674d8067',
'5c6fe13835478b560279ac2f',
'5c73a0f6343a5357615d3049',
'5c7d493a875c98536261291b',
'5c8b524e8c352421eaeb03a9',
'5cb1754654bc7263ff365d08',
'5cb5479d54bc7263ff3baa83',
'5cbbd9a954bc7263ff448cf8',
'5cbc18c83d65ca5e255ee5df',
'5cc49d443d65ca5e2564b4c3',
'5cc5ddd43d65ca5e25654988',
'5cc92dc53d65ca5e25674188',
'5cd44d14d2ee6e6cf2de3bf9',
'5cda7416d2ee6e6cf2e8559a',
'5ce64a3725ee3218d4d9e785',
'5cf7125dc0b26018f5d943a2',
'5cfdf03855623c757c101904',
'5cffd9b5ca6e2921117ab40b',
'5d009e2eca6e2921117b4929',
'5d0210d1c0b26018f5e43109',
'5d03d8e7abbf484763820de8',
'5d067321bf8d5b5fda04921f',
'5d075b312c115b5fd4d1068b',
'5d075dcbbf8d5b5fda05abf6',
'5d07964957152c471e0177b3',
'5d0bc89857152c471e06f802',
'5d0c8ddc0eed7c44be2ab2b1',
'5d0f2dc90eed7c44be2b9d12',
'5d10e86cd1212c6a896c592a',
'5d14702593686945e7062ae9',
'5d1ed8ff3b752c45cf979d08',
'5d20c57693686945e7162d54',
'5d26db8016609737fa46dfa5',
'5d2c3c1f11e17032dcf0b896',
'5d2c537e16609737fa4e7a36',
'5d2c816406ee2c37f1f9c11c',
'5d2f1bf36ed7674e61166e12',
'5d2fccdf6ed7674e6117129b',
'5d35d6035e335b75b152d2dc',
'5d3b14c93860423ec782a15a',
'5d3bc8779996733edb035f93',
'5d3fdf659996733edb085317',
'5d49571fbde10e0d542f68ed',
'5d4fd893bde10e0d5438541e',
'5d57868255fbf50d45f93ce4',
'5d59263d95e84053d766a357',
'5d637aaf357698118393bce0',
'5d664e3dd0286d106d68ff3c',
'5d6a5a4ca24c96105e305e3c',
'5d731ad8d0286d106d7c7150',
'5d73eac6a24c96105e3f5fa2',
'5d7b5a1aa24c96105e4b0f5d',
'5d7dad92a24c96105e4eadb9',
'5d83a550486b0b21476e745d',
'5d88b3f9486b0b214776d859',
'5d9ea492a1f0a71c60614778',
'5dad76eea52eca27857f5a55',
'5daddab2422e2b23e5a1e0a0',
'5dbd2c8934054849201568ea',
'5dc127fc34054849201daee7',
'5dc23f1334054849201ff7f0',
'5dc2aa853087fd49363b91ac',
'5dce4ec80856f146182dff9c',
'5dd1ea9f010c5a46010c4567',
'5dd5089c59e2e3257f793283',
'5dd7ba3f61ebec69bf957ad3',
'5dd7faba61ebec69bf965e0c',
'5dd8e13261ebec69bf982316',
'5ddbc47f6ffaa931412b8bee',
'5de08462fec18c7500b01d26',
'5de3e8a639cbc02e90945633',
'5de4ca1739cbc02e9095338e',
'5de61c01ac56a62ec5e6990e',
'5de7c98623da8b6b4b7f5469',
'5de89b682b420f6b522dd308',
'5dea6931fa8847337e194810',
'5dee5a788b30716fdecadcc2',
'5def5941b619aa257e597cbd',
'5df02ae0d01edf2b243930c6',
'5df2409f1471f12b2a91dfd9',
'5e05dc3210e94832d1734399',
'5e09b8d518576832ff82db85',
'5e0fa2b539136622c07c0abe',
'5e11d5cc89355c2289aa6c09',
'5e11d8d189355c2289aa6ffc',
'5e15867e19c15a286fdfd495',
'5e158d886b240a5b3dec0af0',
'5e23dbcc430121028f98e348',
'5e4183b06bbfd42b2bdfa032',
'5e476a1f14f14a241bbc038d',
'5e47b04dd76b095f5e91269a',
'5e481ac21656846254b63d1c',
'5e4cc1ef7ea4250d5b6cebfd',
'5e4e2d3e65613e429442c5b7',
'5e4e9670431949a347b08e8d',
'5e4f5097b973f646c7798269',
'5e569c8cc764cc6b16473f57',
'5e5f8c8e6738314de260177a',
'5e60accf96c65baac8d46c1f',
'5e63b995f41eb5b058766d03',
'5e650fa92aee86ef49686fe1',
'5e6b230e6ecc857a4addc249',
'5e6cfe51c8fe8344adff9e3d',
'5e6d82e5f5e4a835709fa91e',
'5e76392a98da06f2ee9dfd1d',
'5e7afa3ff496332bf4309f35',
'5eeca801ec73cb82a3459d47',
'5ef32337ec73cb9c39470477',
'5f3410e50fbf9616ff50dcde',
'5f46385608f2ced56b5179d5',
'5f4c82b1f330ba14410c5d42',
'5f4d14e6be98bebd703797b4',
'5f79715cf9451d0e39d978e6',
'5f7ab56bf9451df416d9eaf1',
'5f7d982c28d41499b8322e22',
'5f7ebe94949c03ce2ec00f65',
'5f81309c187b16317b186ac8',
'5f8156a427ab4ecf4e9e002f',
'5f81719a4002049663573e91',
'5f82972f4002045ae6579fc9',
'5f83f3560d1cde78efff3fc4',
'5f848055875b8b64ba689038',
'5f86a8ebb12fa8306bdb3856',
'5f86e6eceb17fe332437c8a6',
'5f86ecb0cd541af37220126b',
'5f87d9b846da1f547437d0a5',
'5f880c5597bae16d7fa151c3',
'5f88288b97bae11413a15e17',
'5f88453497bae15290a16a90',
'5f884554e037d396257e88c9',
'5f88632da4df425349b761d8',
'5f894a4ab71163030adf54ec',
'5f89605bca67591ba7005c80',
'5f8979c7b711635a15df6b52',
'5f897b1dfb10b836f9247fce',
'5f8a955cf60f1c80fcaab7c6',
'5f8a97eb863bfc3ed79d2d22',
'5f8a9f41402ed539fb66560e',
'5f8ab8b1b711639f37dfddec',
'5f8ace4bca6759170e00e31f',
'5f8ae72c402ed590e166728e',
'5f8d5ce8ca6759105901c923',
'5f8d701cca6759660a01d0ca',
'5f8d7690bf0b68c1ac538aff',
'5f90ed39bb047074c7b5aa21',
'5f9156d3893916d158f1a326',
'5f915a82ad20981cb0b5966a',
'5f91693f2c197e18a51ce557',
'5f923c62d8f8406399ee0a22',
'5f924f7cd8f8405c6bee13f5',
'5f9265176e83e44bd2101778',
'5f9271c1d8f840af42ee219e',
'5f92d812103b481e14201886',
'5f93c2508c8b63417e9bcb70',
'5f93e47b041d864f4d4c2df4',
'5f97c1705fd6fc366e9e7d3d',
'5f97c62c5fd6fc92ae9e7f5e',
'5f97ee625acac62332191cf8',
'5f99042f706913b6fdfe52dd',
'5f9912e2fce7300b4edfc368',
'5f9919697069134683fe5b80',
'5f993a46a630207c990eed46',
'5f995d56ff48fe2e58f3714e',
'5f9963ee7069139ef2fe75c3',
'5f9bffc5047afa41e12f3b91',
'5f9d0d7ef9b35a7d4b370aeb',
'5f9d2538ff48fe76e2f4815a',
'5f9e19362f1376534e9f283c',
'5f9fe4d9ff48fe13e9f54f0a',
'5fa0113bff48fe0dbff55e6f',
'5fa24496401c6a588edbbeac',
'5fa2a2b82053eed919114a3b',
'5fa3dae382ecf71a97a78c87',
'5fa4de08ff48fe9062f6cdee',
'5fa50a218a3d6333e20f76db',
'5fa64e9532de97e9868c2127',
'5fa79a33e624dc008d8a9c8c',
'5fa8f1194a320ba4ae6ab054',
'5fab856f90d779d8c6b8ebf0',
'5facdf139954afa03e8cc9a7',
'5facf7e19cd6073e280b4d53',
'5fad3a007e483fdd00f996d3',
'5fafa5d8893352ff34d7818b',
'5fb32a517e483f69d3fb50b9',
'5fb38b4abc2ae57e97a6d606',
'5fb39c3e7a3a354dcb6d6849',
'5fb4bf68e4116201ab22adad',
'5fb6165538dfd08d35be480a',
'5fb61a077118b22860031499',
'5fb67bd97118b2c4400336c1',
'5fb773c46db31f0f8a379dc5',
'5fb8cf0590d7797816bcd1a5',
'5fb8fb2b20edabc38b11c5d9',
'5fb8ff8a106fc33b96ee7df7',
'5fb9101d3b88d75649f7d3bc',
'5fb929f17821ffb5d7a3e5d5',
'5fb9e8cd7e483fc0cafd561f',
'5fba5a2ad2acf54854a2ed2a',
'5fbb53b690d7791cddbd92c8',
'5fbba37fd9cd43552827518f',
'5fbcbdbc40bdefd3ba9588fb',
'5fc10616014147ea360ab39e',
'5fc2ad0b808c7a8a2215c5af',
'5fc38fab01414782070c0afb',
'5fc4a8b1014147816e0c9389',
'5fc4c9f4808c7a92c116e40f',
'5fc5e187c5ea9e6d91371814',
'5fc7115c014147db4a0dbeb3',
'5fc72887a6425e22ffacc7b0',
'5fc7c3d35441f86af742df5b',
'5fc8fea65441f8c8ec4376ae',
'5fc9f4460141478ef80f35af',
'5fcb3292fc9e2055a8905d19',
'5fcdeba13ab0f7c1c1f3840c',
'5fcf4a4d014147d34511e439',
'5fd0660d01414766d812657c',
'5fd071a301414720e5126f80',
'5fd1a90f2ebe76edf92b32d4',
'5fd1abdbce5e6d3799ab15d9',
'5fd1d78b5441f883c547ca42',
'5fd3200b5441f8826b487179',
'5fd339c55441f80c36488467',
'5fd3527d5441f82eaa4896c6',
'5fd487d65e98cd67022f54cc',
'5fd4b3075e98cdd63d2f6dc1',
'5fd5f4b5ecbb3fe5e6266ba3',
'5fd8638c152df310f1ccf240',
'5fd8664a9aa947b58c603385',
'5fd91e6a08e6157c39ca523f',
'5fd9983a49fb26365de78184',
'5fd9c54f49fb269ac2e7a657',
'5fd9e73259db053c098fe6a4',
'5fda261549fb261724e7ea9e',
'5fdb13d64319a785c9b024b2',
'5fdc8bfd7afe7e76e369bada',
'5fdc97747afe7e467669c3a7',
'5fdca79d7afe7e39a869d011',
'5fdcf9c24319a7735bb137d7',
'5fdd8e3fbb140a7b89b123ef',
'5fdf3ad44319a7c176b2734a',
'5fe1ba0c328a86c5c9eff3b8',
'5fe210a6026a40977cca5071',
'5fe245164319a77cb1b406d6',
'5fe3121ab83de261ef0c7c35',
'5fe419cc4319a73424b4cd5b',
'5fe445a012a3e74c0f64a9dc',
'5fe5ddc4026a40eec9cc3794',
'5fe9aab2026a4045eace2aff',
'5fec130eee2e9c49d881bc34',
'5fed7f8bbd3aea05aa38b88e',
'5ff6d515857d1bc28c268472',
'5ff96ad26ac33a014bb83029',
'5ff9e38b87d7410a3b21e5e1',
'5ffd4c9987d74169702360ec',
'5ffd4cef01b191681cba7bc4',
'5ffdbc7620c2ac4b90e2c0c8',
'6006b300857d1b85272d9865',
'600bd699a1baed8184e39bd7',
'600e7917027f250398a2e46e',
'600faf177143236741c29a48',
'600fb276714323f26bc29c76',
'60126d1ca5ef07048c88c559',
'6014e6957143236dd7c4ebe4',
'601e4e7fb3649177f939552a',
'6020e9afa6cc79a6c722d48a',
'60238f27e41c2c13bc521cba',
'6027c25819e4982c0c1dbd70',
'6028d5d9e32da93f96b30048',
'602aaa96e32da9556ab3fb70',
'602d68c5e32da97598b54dea',
'602e123ee32da90036b5910f',
'60349157454cef51795ec947',
'60372df3f7d42e33d65b3f57',
'6038f1f9e9619e837fcea3d1',
'603ddaba654ed5ec1888ac71',
'603f5b3f85047445d2322104',
'6040b49aa5f4caf0f2286639',
'6044845b724f1f511ecc40ca',
'60499f960ebcf5850757f0a7',
'604b4743443ae06e8d54ef0c',
'604c10365e55c354dbcc1ad9',
'6051a7110122e37e4aca9e44',
'60535e8d4316f129c5ff916b',
'6054d02bba88aa707564ce6b',
'6059cc7103f2a42eb31e5cac',
'605ae9129203455abab365ec',
'605c7b8c70424a0d70f5d83a',
'605d7a68b244dc2d14d898ce',
'605db67a476329a980611313',
'605dc539b244dcfa16d8d4a0',
'605ecda567271d8152e4a2d4',
'606197fa193b5c0d8103e86b',
'6061ee0f03f2a485f722da81',
'6062ac876a86e9f6e5fc85f4',
'6063511103f2a4345e237cda',
'606418d0193b5c2c6705168e',
'60655e9ba2f9c51a054fa348',
'60657b1ee774ab2f24491673',
'60681c570292f45d0c154be6',
'60694181a2f9c5dcf2518e8a',
'606b03419772fdfd5767efac',
'606bce7ca2f9c56d7a52ddc8',
'606e881277616052d218d070',
'606fdb917f2983e6cf2507fc',
'6073e957180f920e870f1191',
'607972bb255e27b10cbc8c3d',
'607c59b8c1137321b6b9be5c',
'607d45e78b8a4a54fbe4d81b',
'607e6b24c11373f775ba98f2',
'607e7fb9255e275207bef2b2',
'607fc2f0f5837533beb2979f',
'60822f5cf583755e8eb37c4a',
'60839d62a54f8446a347af0e',
'6086852aa54f84d02f48e52d',
'6087a6b64b2ccd00cfacba52',
'608928fca54f84507649e491',
'608faca9272318ad19200ef6',
'608ffc422723183e3520384e',
'6094c7c30c98f71e1b9841b5',
'60bdfa6129a6940922b773a8',
'60d2cc5f0546892272ddcc46',
'60d40cea0546897fe4de67f1',
'60d463baf5cf11663c95a8bb',
'60d6b4a6569b2605766a58ef',
'60dc137c09aa9938483c3f41',
'60dda82809aa9935983d43b0',
'60ddb544569b26f44a6e7ae4',
'60ddb8c8569b262b7d6e7e0d',
'60deb2ab09aa99294a3dcdf6',
'60efb8b20d1ac7da619dfc41',
'60f955ecd417d435dd7d617a',
'60fa454222600c41336d1bb0',
'60fbb085fe2f60423f869d20',
'611214308dddcbd6316b53fe',
'61149f2cf3519d02dd40ab0c',
'611759088dddcb2ed36e575f',
'611a5169d8ec8ecdb20d1ba2',
'611bb5b4a1477f27c48e5012',
'611d288a255cc36a9d9fb8e6',
'611dda48b8c9cb739715e703',
'6121126701c2c3d5833d68f8',
'612883e334b93d23b332c969',
'6129cae83d08ee8b37274c59',
'6129cb473d08ee1eee274ca2',
'612e879d9db16be87aedd5d5',
'6133394b0a1f1b3975f7b298',
'613734dc7f5ff7277dfece2b',
'613ee79105add50e905ae11e',
'614035127f5ff750b50506fb',
'61404f4c7f5ff7103e05232f',
'614c1e5fe8f223c268ad4854',
'61505715f2602c3db12bcd53',
'61514e4dfd38d3e62b89521e',
'615d29457fefc535bd8a1b47',
'615fdd643cb5bb837b2c32b9',
'61651a37d323b79ab58dd6f5',
'61680be6fbce667e889864cc',
'616e29284c6ba18020d8ebc2',
'617121ca4c6ba12597dae5bf',
'617276a6b9941b24222418b7',
'617958dc5b3fed34857dbe59',
'617d0b7b80efde400acc07bf',
'617ee78a16ec5276c0d18c4b',
'617fe23ac324823345e49df7',
'618a1e85e3dc896a0fe8ceab',
'618d5223c98cb32bf0fc06a0',
'6193545f6837cce38b2f7474',
'61973a7e92730466fa94ccfb',
'6197c0583f25c3c749e1a303',
'6198ae483f25c3d9bee2475b',
'6198c9ea9ce5a3813e2fee38',
'619ba1f65f686bfe8a26470e',
'619d19b73f25c3f532e5c58c',
'619f236c6dc7056c764aa1c5',
'61a87b778472c984e759c580',
'61aaf94d17dd6a4f1a097870',
'61ad7bfef3de6f0ad143f625',
'61aee92cf871730a3d0e80c7',
'61af059df3de6f267f4530f2',
'61af08c017dd6afb1f0ca807',
'61b191b272f1dd1761919881',
'61b2ddefbd965e2c5abcf234',
'61b2e431bd965e85e5bcf791',
'61b9f5934c21d904e83cb137',
'61baab7f5f14f3a4054c0fcf',
'61bd75b1faf602c5cb3c420a',
'61bdf9554fc4130074359e7e',
'61bf29fcd97aca32dd7048ff',
'61bff329b125758ef5624952',
'61c15cae3beb3e3483c90ff6',
'61c5833bdf461973d0d89f27',
'61c99dbeebf26502e175aa6f',
'61cbf541a9fcc30783a65ffb',
'61cc0b354004b90d9874a7a0',
'61d3df9e6fe64101d3f12888',
'61d53d05ac1399a4c9b439b6',
'61d6babe7f6cb529e048d05a',
'61d6ca440a28e3c25cac8390',
'61d7fd28dd82c2487e20d458',
'61d819d6d9d234aa3854a0ce',
'61dc4c225f41a44f1a1fa819',
'61de54f4fb8e4d9649334913',
'61df8a57d80f2b4f9ba6211b',
'61e29d2f93bdd07be9dda5f2',
'61e2aee40fe854ec5f862d7b',
'61e45a8f50f34b8a6c8d1d9c',
'61e5519cd2553eaf178940d5',
'61e643bbb042132c853af443',
'61e649edb042131afb3af9b2',
'61e698319361413bcf5eea69',
'61ea6034ced19303e8b36e18',
'61eb65336916b8452da7dfc6',
'61eb930a63b2be79bc868193',
'61ee3aa86916b8fcd3a9d773',
'61efdaebebef82878e251d75',
'61f266966916b80514ac9978',
'61f37f9f6916b8e8ebad3336',
'61f38b756916b84818ad3db0',
'61f4dfb1c8b478e935dc74db',
'61fb6d2661129cb82c26dd67',
'61fb8d417ac9fd3485a153b1',
'61fcdcfd540ed8dc3c433195',
'61fe46b2d86d1058ade241ce',
'61fe4986d86d105256e24441',
'6200c18e30737358bff28c5c',
'6200ed5e30737325c0f2b28a',
'62025802d2ae40410b98f9e7',
'62048f0d725c4c1844b136a0',
'62080540d96a7ab307bf3f8d',
'620a0e9657d2b23f8faf39d8',
'620baa8efad59918a0bfdc71',
'620d0d5bd96a7a5cb8c27ee3',
'620d447dd96a7a84ecc2a7b3',
'620de8910152021034128a20',
'620df2d863e7c856790761f6',
'620f622cd96a7ab59fc3e00a',
'62176a1d853dd1b1bfc3e801',
'6218756360b553eb21826a64',
'6218f050656bb348449e85a2',
'6219c025c1a4e468f15dc2f6',
'6219dc70f0b26b0ee25b04a6',
'621b1a97ac1f970787ae74ba',
'621cf77ef0b26bfe095d68f3',
'621df80233ff94328f0a5a4c',
'621e3b7c33ff941b590a943d',
'621f63c3e016e7daa3a17242',
'622b4abb1811dca595850937',
'622b4fdd1811dccb21850d07',
'622f1a6fbbd0608ba0e96413',
'623008e0e33a23738da1052f',
'6230832fb73f574a7acec8a4',
'62318e652b721229859c1478',
'62330f1bfb8cbbd5f067a113',
'623882aaa63f416bffd8a1bd',
'623b2943b9a21e1f7dcc2884',
'623c2692f850f8c98e23ec6c',
'623d6702a198e1806e8684b5',
'6240363559c2214a2962197e',
'62405675d1c27cd2e753c547',
'62413a186e78d17ccffa21c4',
'624409fdfbfa43f9bac8573a',
'624434bc1d069131bbca8134',
'624534b863e40dd5ce14e3f3',
'624a91323b51a5daa1ea997a',
'624aa2ab259388834d3d53aa',
'624adab525938845783d7cc8',
'624d3f9cf73d4c35cfcacd07',
'6252aaa528276475ff99bd11',
'62543cdefd03f9c71efdf1ad',
'6256c78232edcd5a30dc5189',
'625fcb5026e6f42996f1e0c5',
'626377a261b1e82112327305',
'62678994aa67db02b91cd49a',
'62679ab0797562db5a42323d',
'6267caeeaa67db66e91d0287',
'6268f664aa396b9203879e51',
'626a3f87ad3d65269593f6e4',
'6274bc9920022e0072877770',
'627a4ab9c75b902088067d2d',
'627b5182d4942229aac3081c',
'627b9ea687b0a63734c5dbb1',
'627cddee9a2aab80bb5bfea4',
'627e04103645c9824f91d0f5',
'627e1d923645c9b41191ea9a',
'627e3b1046fe3b693f591636',
'6280524dcf1a864a7508f3c8',
'62831be579cc7204826638b1',
'62835e8f383becc7200febbd',
'62846d6c1aeb746b24011169',
'6284c18d50881c7a65994407',
'6284f610cf1a86049f0d0061',
'6286eb70cf1a86c0db0e63be',
'62870adfde20662517c45e11',
'628852cb4281e532ef335dfd',
'628c63c9991337707e34f25d',
'628c77cd3a7449bfcd5f73b9',
'628c7ed5de081125764221af',
'62904cc9e5106f54bb9dff8d',
'629061439913374fe5381906',
'62906ffe991337a8d1382693',
'6295b4b774c071dc86507284',
'62962dec970d3970debb7b61',
'629711b999145779820c9240',
'62971c5ca6b6c1bd081b751a',
'6298b195f3675083743ac05f',
'629c21171fdbdeea4ee0db3d',
'629cd180c1ef3ebeeb2cccb0',
'62b41b6d14f9290ecafb0fdb',
'62b5a07f8c7d14b1b306481c',
'62b5eb2bb6ba98aacbc54f08',
'62b8e49d7d7967fefbf45df6',
'62bbd2afc6ae81665ee64b0f',
'62bd07357d796717a9f72cd1',
'62bd8b2fa586e67e7e0d7bd6',
'62c32c1a5bce423777aea65b',
'62c528cc17b40299229ee006',
'62c6308717af9a05796be632',
'62c7c094551cdb4693bf696f',
'62cbbed6551cdb0884c2571a',
'62cbf8aed32c16e098a67d57',
'62cf98625855ad62f9eb20f6',
'62d1093cbb4dfbec5983de65',
'62d2510cb53fa302d32c6edd',
'62d63b8f687a183075185aad',
'62d649b22091d8d65400f38f',
'62d6984fcfb4ee7256637fb2',
'62d6ac3546b3887de8b18961',
'62d7e2296af03d2d53c13939',
'62da9e774354c63912e3ae35',
'62e0fdb76d8d08ef3bc119e6',
'62e0ff3a6d8d08fd61c11af0',
'62e24852cb615708a25c7e9e',
'62e388e1d8a249cbb4af392f',
'62e5c2d3cb615709ac5ecf39',
'62e69cc86d410e227bcfe3bd',
'62e7de5df1e214ef8f90d311',
'62ee13a5cb9a7c2bd5cfc921',
'62f33876efa3e70a90dfbd03',
'62f4cd9b9e82c8bbf4a7a1a5',
'62f88e836c149cb633a73ea8',
'62fddc1e07de6085ce781f95',
'62ff25f885619216e996f8a0',
'63007a0445985b7103c3a808',
'6301a93c04cb1b63150c500d',
'630345a133bc8952d508fbee',
'6309f7c681735c99486cab1a',
'630d9665fb9d0c6cef9605aa',
'630e29b26670f1cb21c0a212',
'63106bc5dbaa3b362c3f22df',
'631578472b45e56f8c36f5e5',
'6318408150e9ee0e1c8bb9be',
'631e3ae1bc07730f40c681e6',
'631e8e3cbc0773021ec6ad78',
'63216919f7a518cefc49bf1d',
'632450ff1152d9aa49ca31f0',
'63288d69bb9d6236692220a7',
'632bbf90868f896f4eb10f4d',
'632d31d9f29a4219636d3268',
'632d7623adb1f8671beb166c',
'632ed8312ac0aa3419df5bd4',
'63314eeba4c572e18111c11c',
'633277c0702da630acf63493',
'633552116b27ad5b4b0d8b36',
'6336aefdc9e099118c3fdfe6',
'633ad5d152124044ebefac5d',
'633ad7fae90ec6f7167d71bd',
'633bb27fa9b2f2f2c96e72aa',
'633fef29e7acac5222d7ed82',
'633ffd6076a9b365ada2856a',
'63411b54be6aa7735e279c9a',
'6345407dd7a401281620a085',
'63490d0045469a0a77756e24',
'63490fb394c4a70e74bc85a9',
'634a4b8b213e322b6c9d82aa',
'634d0f43d4aec2939255e916',
'63526c3ed58af749f6d4c47d',
'635386b4d58af70ce0d58313',
'63569c07eefe8f321f641872',
'635ba530d58af7d280db6625',
'6360b85485b39966b956e234',
'6364df5685b3995c4659abca',
'6367432d85b399b2315b5e97',
'636c8e9639c4ec527a2634f5',
'636dc971ec5c22eda6a68801',
'636dd33fae4832d295d6d5aa',
'636de9fcec5c22dc53a69ee5',
'6372575fb48cddbed2fb1063',
'6375ffc2743ac75620f537b6',
'63773f4683ee530be840a409',
'637e361c5b774180fa7cc350',
'63806f9ce0b9788cd6469958',
'63882e6008087f6234a202af',
'6388606fe368d2b553c40104',
'638993280feaabfd096e44ac',
'638d86d4f34c21ccdfb983f0',
'638d8c645a8f9d241a0a1be5',
'638db3b35a8f9d059c0a3c57',
'638e0fa355f3fa18d6603e78',
'638f27bb33b5cd35cceef5e2',
'639ae004e3d8b5e060c7ca2b',
'639d5b3dcbf93101036c3918',
'63a28dfa92f1c03cb0ca8b20',
'63a2ca9b7a986a5e750d443d',
'63a6f06dc28f680721e73b3f',
'63ae66d17c26210f0f14b811',
'63afcbd642628eda100fccf3',
'63aff9a9de481977bb04eb50',
'63b1aea9825607498d333c99',
'63bd0bd348e9d3693abaac2a',
'63c8d4b6ec19f0c28159349f',
'63c9043d491cc6eb949839da',
'63c91735b07a9c03fce52a70',
'63d6121b63e6d4695c96b2b2',
'63d63569e2fc042f74400401',
'63da0abf7bc906069cc6b5c3',
'63dcd917a0facd2b2228c0cc',
'63e6308f0eb8c31321a04445',
'63eae4c840c28d7740c5bb15',
'63eb286ef021de915b03b2f3',
'63eb587655dc132a313e7df5',
'63ec92a5aab31086827bcde7',
'63eddc48d7e8b237c8ad84c6',
'63ef2402871d6f67434037c4'
    )
group by 
    1, 2
) ord_im left join (select * from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab 
on ord_im.pickup_location_hex_8 = zne_tab.hex_id
group by 
    1, 2 
)

select
*
from 
(
select
    dump_1.*, net_sum, 
    cast(net_orders as double)/net_sum as net_perc
from 
    dump_1
left join (
select
    captain_id, 
    sum(net_orders) as net_sum
from 
    dump_1
group by 
    1 ) sum_dump 
    on dump_1.captain_id = sum_dump.captain_id
)
where 
    net_perc >= 0.8 



    -- limit 10 
-----

newquery login 

with dump_1 as 
(
select
    captain_id, coalesce(zone,'Undefined') as zone, 
    sum(login_hrs) as login_hrs
from 
(
select
    captain_id, location,
    cast(sum(duration) as double)/3600 as login_hrs
from
    datasets.supplycursory_history 
where
    yyyymmdd >= date_format(date('2023-02-13'),'%Y%m%d')
    and  yyyymmdd <= date_format(date('2023-02-26'),'%Y%m%d')
    and status in (2, 3, 6, 7, 8, 10)
    and servicedetailid = '5f6f201a61f57a0007d2aac4'
    and captain_id IN 
    (
    '5c5874d7f2edc733674d8067',
'5c6fe13835478b560279ac2f',
'5c73a0f6343a5357615d3049',
'5c7d493a875c98536261291b',
'5c8b524e8c352421eaeb03a9',
'5cb1754654bc7263ff365d08',
'5cb5479d54bc7263ff3baa83',
'5cbbd9a954bc7263ff448cf8',
'5cbc18c83d65ca5e255ee5df',
'5cc49d443d65ca5e2564b4c3',
'5cc5ddd43d65ca5e25654988',
'5cc92dc53d65ca5e25674188',
'5cd44d14d2ee6e6cf2de3bf9',
'5cda7416d2ee6e6cf2e8559a',
'5ce64a3725ee3218d4d9e785',
'5cf7125dc0b26018f5d943a2',
'5cfdf03855623c757c101904',
'5cffd9b5ca6e2921117ab40b',
'5d009e2eca6e2921117b4929',
'5d0210d1c0b26018f5e43109',
'5d03d8e7abbf484763820de8',
'5d067321bf8d5b5fda04921f',
'5d075b312c115b5fd4d1068b',
'5d075dcbbf8d5b5fda05abf6',
'5d07964957152c471e0177b3',
'5d0bc89857152c471e06f802',
'5d0c8ddc0eed7c44be2ab2b1',
'5d0f2dc90eed7c44be2b9d12',
'5d10e86cd1212c6a896c592a',
'5d14702593686945e7062ae9',
'5d1ed8ff3b752c45cf979d08',
'5d20c57693686945e7162d54',
'5d26db8016609737fa46dfa5',
'5d2c3c1f11e17032dcf0b896',
'5d2c537e16609737fa4e7a36',
'5d2c816406ee2c37f1f9c11c',
'5d2f1bf36ed7674e61166e12',
'5d2fccdf6ed7674e6117129b',
'5d35d6035e335b75b152d2dc',
'5d3b14c93860423ec782a15a',
'5d3bc8779996733edb035f93',
'5d3fdf659996733edb085317',
'5d49571fbde10e0d542f68ed',
'5d4fd893bde10e0d5438541e',
'5d57868255fbf50d45f93ce4',
'5d59263d95e84053d766a357',
'5d637aaf357698118393bce0',
'5d664e3dd0286d106d68ff3c',
'5d6a5a4ca24c96105e305e3c',
'5d731ad8d0286d106d7c7150',
'5d73eac6a24c96105e3f5fa2',
'5d7b5a1aa24c96105e4b0f5d',
'5d7dad92a24c96105e4eadb9',
'5d83a550486b0b21476e745d',
'5d88b3f9486b0b214776d859',
'5d9ea492a1f0a71c60614778',
'5dad76eea52eca27857f5a55',
'5daddab2422e2b23e5a1e0a0',
'5dbd2c8934054849201568ea',
'5dc127fc34054849201daee7',
'5dc23f1334054849201ff7f0',
'5dc2aa853087fd49363b91ac',
'5dce4ec80856f146182dff9c',
'5dd1ea9f010c5a46010c4567',
'5dd5089c59e2e3257f793283',
'5dd7ba3f61ebec69bf957ad3',
'5dd7faba61ebec69bf965e0c',
'5dd8e13261ebec69bf982316',
'5ddbc47f6ffaa931412b8bee',
'5de08462fec18c7500b01d26',
'5de3e8a639cbc02e90945633',
'5de4ca1739cbc02e9095338e',
'5de61c01ac56a62ec5e6990e',
'5de7c98623da8b6b4b7f5469',
'5de89b682b420f6b522dd308',
'5dea6931fa8847337e194810',
'5dee5a788b30716fdecadcc2',
'5def5941b619aa257e597cbd',
'5df02ae0d01edf2b243930c6',
'5df2409f1471f12b2a91dfd9',
'5e05dc3210e94832d1734399',
'5e09b8d518576832ff82db85',
'5e0fa2b539136622c07c0abe',
'5e11d5cc89355c2289aa6c09',
'5e11d8d189355c2289aa6ffc',
'5e15867e19c15a286fdfd495',
'5e158d886b240a5b3dec0af0',
'5e23dbcc430121028f98e348',
'5e4183b06bbfd42b2bdfa032',
'5e476a1f14f14a241bbc038d',
'5e47b04dd76b095f5e91269a',
'5e481ac21656846254b63d1c',
'5e4cc1ef7ea4250d5b6cebfd',
'5e4e2d3e65613e429442c5b7',
'5e4e9670431949a347b08e8d',
'5e4f5097b973f646c7798269',
'5e569c8cc764cc6b16473f57',
'5e5f8c8e6738314de260177a',
'5e60accf96c65baac8d46c1f',
'5e63b995f41eb5b058766d03',
'5e650fa92aee86ef49686fe1',
'5e6b230e6ecc857a4addc249',
'5e6cfe51c8fe8344adff9e3d',
'5e6d82e5f5e4a835709fa91e',
'5e76392a98da06f2ee9dfd1d',
'5e7afa3ff496332bf4309f35',
'5eeca801ec73cb82a3459d47',
'5ef32337ec73cb9c39470477',
'5f3410e50fbf9616ff50dcde',
'5f46385608f2ced56b5179d5',
'5f4c82b1f330ba14410c5d42',
'5f4d14e6be98bebd703797b4',
'5f79715cf9451d0e39d978e6',
'5f7ab56bf9451df416d9eaf1',
'5f7d982c28d41499b8322e22',
'5f7ebe94949c03ce2ec00f65',
'5f81309c187b16317b186ac8',
'5f8156a427ab4ecf4e9e002f',
'5f81719a4002049663573e91',
'5f82972f4002045ae6579fc9',
'5f83f3560d1cde78efff3fc4',
'5f848055875b8b64ba689038',
'5f86a8ebb12fa8306bdb3856',
'5f86e6eceb17fe332437c8a6',
'5f86ecb0cd541af37220126b',
'5f87d9b846da1f547437d0a5',
'5f880c5597bae16d7fa151c3',
'5f88288b97bae11413a15e17',
'5f88453497bae15290a16a90',
'5f884554e037d396257e88c9',
'5f88632da4df425349b761d8',
'5f894a4ab71163030adf54ec',
'5f89605bca67591ba7005c80',
'5f8979c7b711635a15df6b52',
'5f897b1dfb10b836f9247fce',
'5f8a955cf60f1c80fcaab7c6',
'5f8a97eb863bfc3ed79d2d22',
'5f8a9f41402ed539fb66560e',
'5f8ab8b1b711639f37dfddec',
'5f8ace4bca6759170e00e31f',
'5f8ae72c402ed590e166728e',
'5f8d5ce8ca6759105901c923',
'5f8d701cca6759660a01d0ca',
'5f8d7690bf0b68c1ac538aff',
'5f90ed39bb047074c7b5aa21',
'5f9156d3893916d158f1a326',
'5f915a82ad20981cb0b5966a',
'5f91693f2c197e18a51ce557',
'5f923c62d8f8406399ee0a22',
'5f924f7cd8f8405c6bee13f5',
'5f9265176e83e44bd2101778',
'5f9271c1d8f840af42ee219e',
'5f92d812103b481e14201886',
'5f93c2508c8b63417e9bcb70',
'5f93e47b041d864f4d4c2df4',
'5f97c1705fd6fc366e9e7d3d',
'5f97c62c5fd6fc92ae9e7f5e',
'5f97ee625acac62332191cf8',
'5f99042f706913b6fdfe52dd',
'5f9912e2fce7300b4edfc368',
'5f9919697069134683fe5b80',
'5f993a46a630207c990eed46',
'5f995d56ff48fe2e58f3714e',
'5f9963ee7069139ef2fe75c3',
'5f9bffc5047afa41e12f3b91',
'5f9d0d7ef9b35a7d4b370aeb',
'5f9d2538ff48fe76e2f4815a',
'5f9e19362f1376534e9f283c',
'5f9fe4d9ff48fe13e9f54f0a',
'5fa0113bff48fe0dbff55e6f',
'5fa24496401c6a588edbbeac',
'5fa2a2b82053eed919114a3b',
'5fa3dae382ecf71a97a78c87',
'5fa4de08ff48fe9062f6cdee',
'5fa50a218a3d6333e20f76db',
'5fa64e9532de97e9868c2127',
'5fa79a33e624dc008d8a9c8c',
'5fa8f1194a320ba4ae6ab054',
'5fab856f90d779d8c6b8ebf0',
'5facdf139954afa03e8cc9a7',
'5facf7e19cd6073e280b4d53',
'5fad3a007e483fdd00f996d3',
'5fafa5d8893352ff34d7818b',
'5fb32a517e483f69d3fb50b9',
'5fb38b4abc2ae57e97a6d606',
'5fb39c3e7a3a354dcb6d6849',
'5fb4bf68e4116201ab22adad',
'5fb6165538dfd08d35be480a',
'5fb61a077118b22860031499',
'5fb67bd97118b2c4400336c1',
'5fb773c46db31f0f8a379dc5',
'5fb8cf0590d7797816bcd1a5',
'5fb8fb2b20edabc38b11c5d9',
'5fb8ff8a106fc33b96ee7df7',
'5fb9101d3b88d75649f7d3bc',
'5fb929f17821ffb5d7a3e5d5',
'5fb9e8cd7e483fc0cafd561f',
'5fba5a2ad2acf54854a2ed2a',
'5fbb53b690d7791cddbd92c8',
'5fbba37fd9cd43552827518f',
'5fbcbdbc40bdefd3ba9588fb',
'5fc10616014147ea360ab39e',
'5fc2ad0b808c7a8a2215c5af',
'5fc38fab01414782070c0afb',
'5fc4a8b1014147816e0c9389',
'5fc4c9f4808c7a92c116e40f',
'5fc5e187c5ea9e6d91371814',
'5fc7115c014147db4a0dbeb3',
'5fc72887a6425e22ffacc7b0',
'5fc7c3d35441f86af742df5b',
'5fc8fea65441f8c8ec4376ae',
'5fc9f4460141478ef80f35af',
'5fcb3292fc9e2055a8905d19',
'5fcdeba13ab0f7c1c1f3840c',
'5fcf4a4d014147d34511e439',
'5fd0660d01414766d812657c',
'5fd071a301414720e5126f80',
'5fd1a90f2ebe76edf92b32d4',
'5fd1abdbce5e6d3799ab15d9',
'5fd1d78b5441f883c547ca42',
'5fd3200b5441f8826b487179',
'5fd339c55441f80c36488467',
'5fd3527d5441f82eaa4896c6',
'5fd487d65e98cd67022f54cc',
'5fd4b3075e98cdd63d2f6dc1',
'5fd5f4b5ecbb3fe5e6266ba3',
'5fd8638c152df310f1ccf240',
'5fd8664a9aa947b58c603385',
'5fd91e6a08e6157c39ca523f',
'5fd9983a49fb26365de78184',
'5fd9c54f49fb269ac2e7a657',
'5fd9e73259db053c098fe6a4',
'5fda261549fb261724e7ea9e',
'5fdb13d64319a785c9b024b2',
'5fdc8bfd7afe7e76e369bada',
'5fdc97747afe7e467669c3a7',
'5fdca79d7afe7e39a869d011',
'5fdcf9c24319a7735bb137d7',
'5fdd8e3fbb140a7b89b123ef',
'5fdf3ad44319a7c176b2734a',
'5fe1ba0c328a86c5c9eff3b8',
'5fe210a6026a40977cca5071',
'5fe245164319a77cb1b406d6',
'5fe3121ab83de261ef0c7c35',
'5fe419cc4319a73424b4cd5b',
'5fe445a012a3e74c0f64a9dc',
'5fe5ddc4026a40eec9cc3794',
'5fe9aab2026a4045eace2aff',
'5fec130eee2e9c49d881bc34',
'5fed7f8bbd3aea05aa38b88e',
'5ff6d515857d1bc28c268472',
'5ff96ad26ac33a014bb83029',
'5ff9e38b87d7410a3b21e5e1',
'5ffd4c9987d74169702360ec',
'5ffd4cef01b191681cba7bc4',
'5ffdbc7620c2ac4b90e2c0c8',
'6006b300857d1b85272d9865',
'600bd699a1baed8184e39bd7',
'600e7917027f250398a2e46e',
'600faf177143236741c29a48',
'600fb276714323f26bc29c76',
'60126d1ca5ef07048c88c559',
'6014e6957143236dd7c4ebe4',
'601e4e7fb3649177f939552a',
'6020e9afa6cc79a6c722d48a',
'60238f27e41c2c13bc521cba',
'6027c25819e4982c0c1dbd70',
'6028d5d9e32da93f96b30048',
'602aaa96e32da9556ab3fb70',
'602d68c5e32da97598b54dea',
'602e123ee32da90036b5910f',
'60349157454cef51795ec947',
'60372df3f7d42e33d65b3f57',
'6038f1f9e9619e837fcea3d1',
'603ddaba654ed5ec1888ac71',
'603f5b3f85047445d2322104',
'6040b49aa5f4caf0f2286639',
'6044845b724f1f511ecc40ca',
'60499f960ebcf5850757f0a7',
'604b4743443ae06e8d54ef0c',
'604c10365e55c354dbcc1ad9',
'6051a7110122e37e4aca9e44',
'60535e8d4316f129c5ff916b',
'6054d02bba88aa707564ce6b',
'6059cc7103f2a42eb31e5cac',
'605ae9129203455abab365ec',
'605c7b8c70424a0d70f5d83a',
'605d7a68b244dc2d14d898ce',
'605db67a476329a980611313',
'605dc539b244dcfa16d8d4a0',
'605ecda567271d8152e4a2d4',
'606197fa193b5c0d8103e86b',
'6061ee0f03f2a485f722da81',
'6062ac876a86e9f6e5fc85f4',
'6063511103f2a4345e237cda',
'606418d0193b5c2c6705168e',
'60655e9ba2f9c51a054fa348',
'60657b1ee774ab2f24491673',
'60681c570292f45d0c154be6',
'60694181a2f9c5dcf2518e8a',
'606b03419772fdfd5767efac',
'606bce7ca2f9c56d7a52ddc8',
'606e881277616052d218d070',
'606fdb917f2983e6cf2507fc',
'6073e957180f920e870f1191',
'607972bb255e27b10cbc8c3d',
'607c59b8c1137321b6b9be5c',
'607d45e78b8a4a54fbe4d81b',
'607e6b24c11373f775ba98f2',
'607e7fb9255e275207bef2b2',
'607fc2f0f5837533beb2979f',
'60822f5cf583755e8eb37c4a',
'60839d62a54f8446a347af0e',
'6086852aa54f84d02f48e52d',
'6087a6b64b2ccd00cfacba52',
'608928fca54f84507649e491',
'608faca9272318ad19200ef6',
'608ffc422723183e3520384e',
'6094c7c30c98f71e1b9841b5',
'60bdfa6129a6940922b773a8',
'60d2cc5f0546892272ddcc46',
'60d40cea0546897fe4de67f1',
'60d463baf5cf11663c95a8bb',
'60d6b4a6569b2605766a58ef',
'60dc137c09aa9938483c3f41',
'60dda82809aa9935983d43b0',
'60ddb544569b26f44a6e7ae4',
'60ddb8c8569b262b7d6e7e0d',
'60deb2ab09aa99294a3dcdf6',
'60efb8b20d1ac7da619dfc41',
'60f955ecd417d435dd7d617a',
'60fa454222600c41336d1bb0',
'60fbb085fe2f60423f869d20',
'611214308dddcbd6316b53fe',
'61149f2cf3519d02dd40ab0c',
'611759088dddcb2ed36e575f',
'611a5169d8ec8ecdb20d1ba2',
'611bb5b4a1477f27c48e5012',
'611d288a255cc36a9d9fb8e6',
'611dda48b8c9cb739715e703',
'6121126701c2c3d5833d68f8',
'612883e334b93d23b332c969',
'6129cae83d08ee8b37274c59',
'6129cb473d08ee1eee274ca2',
'612e879d9db16be87aedd5d5',
'6133394b0a1f1b3975f7b298',
'613734dc7f5ff7277dfece2b',
'613ee79105add50e905ae11e',
'614035127f5ff750b50506fb',
'61404f4c7f5ff7103e05232f',
'614c1e5fe8f223c268ad4854',
'61505715f2602c3db12bcd53',
'61514e4dfd38d3e62b89521e',
'615d29457fefc535bd8a1b47',
'615fdd643cb5bb837b2c32b9',
'61651a37d323b79ab58dd6f5',
'61680be6fbce667e889864cc',
'616e29284c6ba18020d8ebc2',
'617121ca4c6ba12597dae5bf',
'617276a6b9941b24222418b7',
'617958dc5b3fed34857dbe59',
'617d0b7b80efde400acc07bf',
'617ee78a16ec5276c0d18c4b',
'617fe23ac324823345e49df7',
'618a1e85e3dc896a0fe8ceab',
'618d5223c98cb32bf0fc06a0',
'6193545f6837cce38b2f7474',
'61973a7e92730466fa94ccfb',
'6197c0583f25c3c749e1a303',
'6198ae483f25c3d9bee2475b',
'6198c9ea9ce5a3813e2fee38',
'619ba1f65f686bfe8a26470e',
'619d19b73f25c3f532e5c58c',
'619f236c6dc7056c764aa1c5',
'61a87b778472c984e759c580',
'61aaf94d17dd6a4f1a097870',
'61ad7bfef3de6f0ad143f625',
'61aee92cf871730a3d0e80c7',
'61af059df3de6f267f4530f2',
'61af08c017dd6afb1f0ca807',
'61b191b272f1dd1761919881',
'61b2ddefbd965e2c5abcf234',
'61b2e431bd965e85e5bcf791',
'61b9f5934c21d904e83cb137',
'61baab7f5f14f3a4054c0fcf',
'61bd75b1faf602c5cb3c420a',
'61bdf9554fc4130074359e7e',
'61bf29fcd97aca32dd7048ff',
'61bff329b125758ef5624952',
'61c15cae3beb3e3483c90ff6',
'61c5833bdf461973d0d89f27',
'61c99dbeebf26502e175aa6f',
'61cbf541a9fcc30783a65ffb',
'61cc0b354004b90d9874a7a0',
'61d3df9e6fe64101d3f12888',
'61d53d05ac1399a4c9b439b6',
'61d6babe7f6cb529e048d05a',
'61d6ca440a28e3c25cac8390',
'61d7fd28dd82c2487e20d458',
'61d819d6d9d234aa3854a0ce',
'61dc4c225f41a44f1a1fa819',
'61de54f4fb8e4d9649334913',
'61df8a57d80f2b4f9ba6211b',
'61e29d2f93bdd07be9dda5f2',
'61e2aee40fe854ec5f862d7b',
'61e45a8f50f34b8a6c8d1d9c',
'61e5519cd2553eaf178940d5',
'61e643bbb042132c853af443',
'61e649edb042131afb3af9b2',
'61e698319361413bcf5eea69',
'61ea6034ced19303e8b36e18',
'61eb65336916b8452da7dfc6',
'61eb930a63b2be79bc868193',
'61ee3aa86916b8fcd3a9d773',
'61efdaebebef82878e251d75',
'61f266966916b80514ac9978',
'61f37f9f6916b8e8ebad3336',
'61f38b756916b84818ad3db0',
'61f4dfb1c8b478e935dc74db',
'61fb6d2661129cb82c26dd67',
'61fb8d417ac9fd3485a153b1',
'61fcdcfd540ed8dc3c433195',
'61fe46b2d86d1058ade241ce',
'61fe4986d86d105256e24441',
'6200c18e30737358bff28c5c',
'6200ed5e30737325c0f2b28a',
'62025802d2ae40410b98f9e7',
'62048f0d725c4c1844b136a0',
'62080540d96a7ab307bf3f8d',
'620a0e9657d2b23f8faf39d8',
'620baa8efad59918a0bfdc71',
'620d0d5bd96a7a5cb8c27ee3',
'620d447dd96a7a84ecc2a7b3',
'620de8910152021034128a20',
'620df2d863e7c856790761f6',
'620f622cd96a7ab59fc3e00a',
'62176a1d853dd1b1bfc3e801',
'6218756360b553eb21826a64',
'6218f050656bb348449e85a2',
'6219c025c1a4e468f15dc2f6',
'6219dc70f0b26b0ee25b04a6',
'621b1a97ac1f970787ae74ba',
'621cf77ef0b26bfe095d68f3',
'621df80233ff94328f0a5a4c',
'621e3b7c33ff941b590a943d',
'621f63c3e016e7daa3a17242',
'622b4abb1811dca595850937',
'622b4fdd1811dccb21850d07',
'622f1a6fbbd0608ba0e96413',
'623008e0e33a23738da1052f',
'6230832fb73f574a7acec8a4',
'62318e652b721229859c1478',
'62330f1bfb8cbbd5f067a113',
'623882aaa63f416bffd8a1bd',
'623b2943b9a21e1f7dcc2884',
'623c2692f850f8c98e23ec6c',
'623d6702a198e1806e8684b5',
'6240363559c2214a2962197e',
'62405675d1c27cd2e753c547',
'62413a186e78d17ccffa21c4',
'624409fdfbfa43f9bac8573a',
'624434bc1d069131bbca8134',
'624534b863e40dd5ce14e3f3',
'624a91323b51a5daa1ea997a',
'624aa2ab259388834d3d53aa',
'624adab525938845783d7cc8',
'624d3f9cf73d4c35cfcacd07',
'6252aaa528276475ff99bd11',
'62543cdefd03f9c71efdf1ad',
'6256c78232edcd5a30dc5189',
'625fcb5026e6f42996f1e0c5',
'626377a261b1e82112327305',
'62678994aa67db02b91cd49a',
'62679ab0797562db5a42323d',
'6267caeeaa67db66e91d0287',
'6268f664aa396b9203879e51',
'626a3f87ad3d65269593f6e4',
'6274bc9920022e0072877770',
'627a4ab9c75b902088067d2d',
'627b5182d4942229aac3081c',
'627b9ea687b0a63734c5dbb1',
'627cddee9a2aab80bb5bfea4',
'627e04103645c9824f91d0f5',
'627e1d923645c9b41191ea9a',
'627e3b1046fe3b693f591636',
'6280524dcf1a864a7508f3c8',
'62831be579cc7204826638b1',
'62835e8f383becc7200febbd',
'62846d6c1aeb746b24011169',
'6284c18d50881c7a65994407',
'6284f610cf1a86049f0d0061',
'6286eb70cf1a86c0db0e63be',
'62870adfde20662517c45e11',
'628852cb4281e532ef335dfd',
'628c63c9991337707e34f25d',
'628c77cd3a7449bfcd5f73b9',
'628c7ed5de081125764221af',
'62904cc9e5106f54bb9dff8d',
'629061439913374fe5381906',
'62906ffe991337a8d1382693',
'6295b4b774c071dc86507284',
'62962dec970d3970debb7b61',
'629711b999145779820c9240',
'62971c5ca6b6c1bd081b751a',
'6298b195f3675083743ac05f',
'629c21171fdbdeea4ee0db3d',
'629cd180c1ef3ebeeb2cccb0',
'62b41b6d14f9290ecafb0fdb',
'62b5a07f8c7d14b1b306481c',
'62b5eb2bb6ba98aacbc54f08',
'62b8e49d7d7967fefbf45df6',
'62bbd2afc6ae81665ee64b0f',
'62bd07357d796717a9f72cd1',
'62bd8b2fa586e67e7e0d7bd6',
'62c32c1a5bce423777aea65b',
'62c528cc17b40299229ee006',
'62c6308717af9a05796be632',
'62c7c094551cdb4693bf696f',
'62cbbed6551cdb0884c2571a',
'62cbf8aed32c16e098a67d57',
'62cf98625855ad62f9eb20f6',
'62d1093cbb4dfbec5983de65',
'62d2510cb53fa302d32c6edd',
'62d63b8f687a183075185aad',
'62d649b22091d8d65400f38f',
'62d6984fcfb4ee7256637fb2',
'62d6ac3546b3887de8b18961',
'62d7e2296af03d2d53c13939',
'62da9e774354c63912e3ae35',
'62e0fdb76d8d08ef3bc119e6',
'62e0ff3a6d8d08fd61c11af0',
'62e24852cb615708a25c7e9e',
'62e388e1d8a249cbb4af392f',
'62e5c2d3cb615709ac5ecf39',
'62e69cc86d410e227bcfe3bd',
'62e7de5df1e214ef8f90d311',
'62ee13a5cb9a7c2bd5cfc921',
'62f33876efa3e70a90dfbd03',
'62f4cd9b9e82c8bbf4a7a1a5',
'62f88e836c149cb633a73ea8',
'62fddc1e07de6085ce781f95',
'62ff25f885619216e996f8a0',
'63007a0445985b7103c3a808',
'6301a93c04cb1b63150c500d',
'630345a133bc8952d508fbee',
'6309f7c681735c99486cab1a',
'630d9665fb9d0c6cef9605aa',
'630e29b26670f1cb21c0a212',
'63106bc5dbaa3b362c3f22df',
'631578472b45e56f8c36f5e5',
'6318408150e9ee0e1c8bb9be',
'631e3ae1bc07730f40c681e6',
'631e8e3cbc0773021ec6ad78',
'63216919f7a518cefc49bf1d',
'632450ff1152d9aa49ca31f0',
'63288d69bb9d6236692220a7',
'632bbf90868f896f4eb10f4d',
'632d31d9f29a4219636d3268',
'632d7623adb1f8671beb166c',
'632ed8312ac0aa3419df5bd4',
'63314eeba4c572e18111c11c',
'633277c0702da630acf63493',
'633552116b27ad5b4b0d8b36',
'6336aefdc9e099118c3fdfe6',
'633ad5d152124044ebefac5d',
'633ad7fae90ec6f7167d71bd',
'633bb27fa9b2f2f2c96e72aa',
'633fef29e7acac5222d7ed82',
'633ffd6076a9b365ada2856a',
'63411b54be6aa7735e279c9a',
'6345407dd7a401281620a085',
'63490d0045469a0a77756e24',
'63490fb394c4a70e74bc85a9',
'634a4b8b213e322b6c9d82aa',
'634d0f43d4aec2939255e916',
'63526c3ed58af749f6d4c47d',
'635386b4d58af70ce0d58313',
'63569c07eefe8f321f641872',
'635ba530d58af7d280db6625',
'6360b85485b39966b956e234',
'6364df5685b3995c4659abca',
'6367432d85b399b2315b5e97',
'636c8e9639c4ec527a2634f5',
'636dc971ec5c22eda6a68801',
'636dd33fae4832d295d6d5aa',
'636de9fcec5c22dc53a69ee5',
'6372575fb48cddbed2fb1063',
'6375ffc2743ac75620f537b6',
'63773f4683ee530be840a409',
'637e361c5b774180fa7cc350',
'63806f9ce0b9788cd6469958',
'63882e6008087f6234a202af',
'6388606fe368d2b553c40104',
'638993280feaabfd096e44ac',
'638d86d4f34c21ccdfb983f0',
'638d8c645a8f9d241a0a1be5',
'638db3b35a8f9d059c0a3c57',
'638e0fa355f3fa18d6603e78',
'638f27bb33b5cd35cceef5e2',
'639ae004e3d8b5e060c7ca2b',
'639d5b3dcbf93101036c3918',
'63a28dfa92f1c03cb0ca8b20',
'63a2ca9b7a986a5e750d443d',
'63a6f06dc28f680721e73b3f',
'63ae66d17c26210f0f14b811',
'63afcbd642628eda100fccf3',
'63aff9a9de481977bb04eb50',
'63b1aea9825607498d333c99',
'63bd0bd348e9d3693abaac2a',
'63c8d4b6ec19f0c28159349f',
'63c9043d491cc6eb949839da',
'63c91735b07a9c03fce52a70',
'63d6121b63e6d4695c96b2b2',
'63d63569e2fc042f74400401',
'63da0abf7bc906069cc6b5c3',
'63dcd917a0facd2b2228c0cc',
'63e6308f0eb8c31321a04445',
'63eae4c840c28d7740c5bb15',
'63eb286ef021de915b03b2f3',
'63eb587655dc132a313e7df5',
'63ec92a5aab31086827bcde7',
'63eddc48d7e8b237c8ad84c6',
'63ef2402871d6f67434037c4'
    )
group by 
    1, 2
) ord_im left join (select * from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab 
on ord_im.location = zne_tab.hex_id
group by 
    1, 2 
)

select
*
from 
(
select
    dump_1.*, login_sum, 
    cast(login_hrs as double)/login_sum as login_perc
from 
    dump_1
left join (
select
    captain_id, 
    sum(login_hrs) as login_sum
from 
    dump_1
group by 
    1 ) sum_dump 
    on dump_1.captain_id = sum_dump.captain_id
)
where 
    login_perc >= 0.7 



    -- limit 10 

---- 
newquery cumulative summary - accepted_pings
with pings_dump as 
(
select
    captain_id, 
    (case when zone_pick is null or zone_pick >= '1' then '1+' else '0' end) as zone_pick,
    (case when zone_drop is null or zone_drop >= '1' then '1+' else '0' end) as zone_drop,
    sum(total_pings) as total_pings, sum(accepted_pings) as accepted_pings
from 
(
select 
    captain_id, pickup_location_hex_8, drop_location_hex_8,
    count(order_id) as total_pings,
    count(case when event_type = 'accepted' then order_id end) as accepted_pings
from 
    orders.order_logs_immutable 
where 
    yyyymmdd >= date_format(date('2023-02-13'),'%Y%m%d')
    and  yyyymmdd <= date_format(date('2023-02-26'),'%Y%m%d')
    and service_obj_service_name = 'Auto'
    and service_obj_city_display_name = 'Chennai'
    and event_type in ('rider_reject', 'rider_busy', 'accepted')
    and captain_id IN (select captainid from reports_internal.caps_dump_stay_in_area_623)
group by 
    1, 2, 3 
) ord_im 

left join (select distinct hex_id as hex_pick, zone as zone_pick from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab_pick 
on ord_im.pickup_location_hex_8 = zne_tab_pick.hex_pick

left join (select distinct hex_id as hex_drop, zone as zone_drop from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab_drop
on ord_im.drop_location_hex_8 = zne_tab_drop.hex_drop

group by 
    1, 2, 3 
)

,net_dump as
(
select
    captain_id, 
    (case when zone_pick is null or zone_pick >= '1' then '1+' else '0' end) as zone_pick,
    (case when zone_drop is null or zone_drop >= '1' then '1+' else '0' end) as zone_drop,
    sum(net_orders) as net_orders
from 
(
select 
    captain_id, pickup_location_hex_8, drop_location_hex_8,
    count(distinct order_id) as net_orders
from 
    orders.order_logs_snapshot
where 
    yyyymmdd >= date_format(date('2023-02-13'),'%Y%m%d')
    and  yyyymmdd <= date_format(date('2023-02-26'),'%Y%m%d')
    and service_obj_service_name = 'Auto'
    and service_obj_city_display_name = 'Chennai'
    and order_status = 'dropped'
    and (spd_fraud_flag = false or spd_fraud_flag is null)
    and captain_id IN (select captainid from reports_internal.caps_dump_stay_in_area_623)
group by 
    1, 2, 3 
) ord_im 

left join (select distinct hex_id as hex_pick, zone as zone_pick from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab_pick 
on ord_im.pickup_location_hex_8 = zne_tab_pick.hex_pick

left join (select distinct hex_id as hex_drop, zone as zone_drop from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab_drop
on ord_im.drop_location_hex_8 = zne_tab_drop.hex_drop

group by 
    1, 2, 3 
)

select
    zone_pick, zone_drop,
    
    sum(total_pings) as total_pings,
    count(distinct case when total_pings > 0 then captain_id end) as pinged_caps,
    
    sum(accepted_pings) as accepted_pings,
    count(distinct case when accepted_pings > 0 then captain_id end) as accept_caps,
    
    sum(net_orders) as net_orders,
    count(distinct case when net_orders > 0 then captain_id end) as net_caps 
from 
    (
    select
        pings_dump.*, coalesce(net_orders,0) as net_orders
    from 
        pings_dump left join net_dump
    on 
        pings_dump.captain_id = net_dump.captain_id
        and pings_dump.zone_pick = net_dump.zone_pick
        and pings_dump.zone_drop = net_dump.zone_drop
    )
group by 
    1, 2
order by 
    1, 2

-- limit 10 

----

newquery login 
-- with dump_1 as 
-- (
select
    zone, session,
    sum(login_hrs) as login_hrs,
    count(distinct captain_id) as login_caps 
from 
    (
--     select
--         *, 
--         row_number() over(partition by captain_id order by login_hrs desc, zone) as log_num
--     from 
--         (
        select
            captain_id, session,
            zone, -- (case when zone is null or zone >= '1' then '1+' else '0' end) as zone,
            sum(login_hrs) as login_hrs
        from 
        (
        select
            captain_id, location,
            
            (case when substr(quarter_hour, 1, 2) >= '06' and substr(quarter_hour,1,2) < '12' then 'Mrng' else 
                case when substr(quarter_hour, 1, 2) >= '12' and substr(quarter_hour,1,2) < '17' then 'Aftn' else
                    case when substr(quarter_hour, 1, 2) >= '17' and substr(quarter_hour,1,2) < '22' then 'Evng' else 
                        'Night' 
                    end 
                end 
            end) as session,
            
            cast(sum(duration) as double)/3600 as login_hrs
        from
            datasets.supplycursory_history 
        where
            yyyymmdd >= date_format(date('2023-02-13'),'%Y%m%d')
            and  yyyymmdd <= date_format(date('2023-02-26'),'%Y%m%d')
            and status in (2, 3, 6, 7, 8, 10)
            and servicedetailid = '5f6f201a61f57a0007d2aac4'
            and captain_id IN (select captainid from reports_internal.caps_dump_stay_in_area_623)
        group by 
            1, 2, 3 
        ) ord_im left join (select * from datasets_internal.auto_city_zones_v0 where city = 'Chennai') zne_tab 
        on ord_im.location = zne_tab.hex_id
        group by 
            1, 2, 3  
        )
--     )
-- where 
--     log_num = 1 
group by 
    1, 2 
order by
    1, 
    (case when session = 'Mrng' then 1 
        when session = 'Aftn' then 2 
        when session = 'Evng' then 3
        else 4 
    end)

-- select
-- *
-- from 
-- (
-- select
--     dump_1.*, login_sum, 
--     cast(login_hrs as double)/login_sum as login_perc
-- from 
--     dump_1
-- left join (
-- select
--     captain_id, 
--     sum(login_hrs) as login_sum
-- from 
--     dump_1
-- group by 
--     1 ) sum_dump 
--     on dump_1.captain_id = sum_dump.captain_id
-- )
-- where 
--     login_perc >= 0.7 



    -- limit 10 